std := load('samples/std')
range := std.range
each := std.each
log := std.log
get := load('samples/requests').get

# TODO: remove whole file
auth := 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ1UmFlbnl0V1JnajFjMVRCUXpHTFpFdm5ETVNNSDMyaE1IOXhnMjV2SU1vIn0.eyJleHAiOjE3MjI5MzY4MzcsImlhdCI6MTcyMjkzNjUzNywiYXV0aF90aW1lIjoxNzIyOTMxNjA3LCJqdGkiOiJmMTdlNjU3Ni05ZWYzLTQzNzEtYmFjZS0yMTA3Mjc5YjZiYjEiLCJpc3MiOiJodHRwczovL3Nzby10ZXN0Lm8zLnJ1L2F1dGgvcmVhbG1zL3N0ZyIsImF1ZCI6WyJrOHMuaXQtY3Jvd2QiLCJrOHMuYXV0aC1kaXNwYXRjaGVyIiwiazhzLmFsZXJ0cy1yZWdpc3RyeSJdLCJzdWIiOiI5MzFjNTU0OS0xZjkwLTRlNDQtODkwYS03ZTc4ODBkMDUwMzMiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJrOHMuaXQtY3Jvd2QiLCJzZXNzaW9uX3N0YXRlIjoiYmQyNzA4ZGMtMDFiNy00MTkwLTg1NTItYjY0YzUwNWUxNTgzIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLTIwMjQtMDctMjUtMDctY2xpY2tob3VzZS5vLXN0Zy5jLm8zLnJ1IiwiaHR0cDovL2l0LWNyb3dkLWxhdGVzdC5zdGcucy5vMy5ydSIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLXByb2ZpbGUtc3RvcmUtcGluaWEuaXQtY3Jvd2Quc3ZjLnN0Zy5rOHMubzMucnUiLCJodHRwOi8vaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTE3LTAzLml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1Ojg0IiwiaHR0cHM6Ly9pdC1jcm93ZC1sYXRlc3Qtc3RnLm96b25ydS5tZSIsImh0dHBzOi8vaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTE3LTAzLXN0Zy5vem9ucnUubWUiLCJodHRwOi8vaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTIzLTA0LWNyb25qb2JzLml0LWNyb3dkLnN2Yy5jbHVzdGVyLmxvY2FsIiwiaHR0cDovL2l0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0yMy0wNC1jcm9uam9icy5vLXN0Zy5jLm8zLnJ1IiwiaHR0cDovL2l0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0xNy0wMy5pdC1jcm93ZC5rOHMiLCJodHRwOi8vaXQtY3Jvd2QtcmVsZWFzZS1wcm9maWxlLXN0b3JlLXBpbmlhLml0LWNyb3dkLms4cyIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLXByb2ZpbGUtc3RvcmUtcGluaWEuby1zdGcuYy5vMy5ydSIsImh0dHA6Ly9hbnkuaXQtY3Jvd2QtcmVsZWFzZS1wcm9maWxlLXN0b3JlLXBpbmlhLml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1Ojg0IiwiaHR0cDovL2l0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0xNy0wMy5pdC1jcm93ZC5zdmMuY2x1c3Rlci5sb2NhbCIsImh0dHA6Ly9hbnkuaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTIzLTA0LWNyb25qb2JzLml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1IiwiaHR0cDovL2xvY2FsaG9zdDoxMzcyNyIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLTIwMjQtMDctMjUtMDctY2xpY2tob3VzZS5pdC1jcm93ZC5zdmMuY2x1c3Rlci5sb2NhbCIsImh0dHA6Ly9hbnkuaXQtY3Jvd2QtbGF0ZXN0Lml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1aHR0cDoiLCJodHRwOi8vaXQtY3Jvd2QtbGF0ZXN0Lm8tc3RnLmMubzMucnUiLCJodHRwOi8vYW55Lml0LWNyb3dkLXJlbGVhc2UtcHJvZmlsZS1zdG9yZS1waW5pYS5pdC1jcm93ZC5zdmMuc3RnLms4cy5vMy5ydSIsImh0dHA6Ly9pdC1jcm93ZC1sYXRlc3Quc3RnLmEubzMucnUiLCJodHRwOi8vYW55Lml0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0xNy0wMy5pdC1jcm93ZC5zdmMuc3RnLms4cy5vMy5ydTo4NCIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLXByb2ZpbGUtc3RvcmUtcGluaWEuaXQtY3Jvd2Quc3ZjLmNsdXN0ZXIubG9jYWwiLCJodHRwOi8vaXQtY3Jvd2QtbGF0ZXN0Lml0LWNyb3dkLms4cyIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLTIwMjQtMDctMjUtMDctY2xpY2tob3VzZS5pdC1jcm93ZC5zdmMuc3RnLms4cy5vMy5ydSIsImh0dHA6Ly9hbnkuaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTI1LTA3LWNsaWNraG91c2UuaXQtY3Jvd2Quc3ZjLnN0Zy5rOHMubzMucnUiLCJodHRwOi8vaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTE3LTAzLml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1IiwiaHR0cDovL2l0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0yNS0wNy1jbGlja2hvdXNlLml0LWNyb3dkLms4cyIsIioiLCJodHRwOi8vaXQtY3Jvd2QtbGF0ZXN0Lml0LWNyb3dkLnN2Yy5jbHVzdGVyLmxvY2FsIiwiaHR0cHM6Ly9zMnMtY29udHJvbC1wbGFuZS50Lm8zLnJ1IiwiaHR0cDovL2l0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0xNy0wMy5vLXN0Zy5jLm8zLnJ1IiwiaHR0cDovL2l0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0yMy0wNC1jcm9uam9icy5pdC1jcm93ZC5rOHMiLCJodHRwOi8vYW55Lml0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0yNS0wNy1jbGlja2hvdXNlLml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1Ojg0IiwiaHR0cDovL2FueS5pdC1jcm93ZC1sYXRlc3QuaXQtY3Jvd2Quc3ZjLnN0Zy5rOHMubzMucnU6ODQiLCJodHRwOi8vYW55Lml0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0xNy0wMy5pdC1jcm93ZC5zdmMuc3RnLms4cy5vMy5ydSIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLTIwMjQtMDctMTctMDMuc3RnLnMubzMucnUiLCJodHRwOi8vYW55Lml0LWNyb3dkLWxhdGVzdC5pdC1jcm93ZC5zdmMuc3RnLms4cy5vMy5ydSIsImh0dHA6Ly9pdC1jcm93ZC1yZWxlYXNlLTIwMjQtMDctMTctMDMuc3RnLmEubzMucnUiLCJodHRwczovL2xzYy1mb3JlbWFuLnByb2QuYS5vMy5ydSIsImh0dHA6Ly9pdC1jcm93ZC1sYXRlc3QuaXQtY3Jvd2Quc3ZjLnN0Zy5rOHMubzMucnU6ODQiLCJodHRwOi8vYW55Lml0LWNyb3dkLXJlbGVhc2UtMjAyNC0wNy0yMy0wNC1jcm9uam9icy5pdC1jcm93ZC5zdmMuc3RnLms4cy5vMy5ydTo4NCIsImh0dHA6Ly9hbnkuaXQtY3Jvd2QtcmVsZWFzZS1zY3lsbGEtbWljcm9zZXJ2aWNlLTAxLTA3LTIwMjQuaXQtY3Jvd2Quc3ZjLnN0Zy5rOHMubzMucnVodHRwOiIsImh0dHA6Ly9pdC1jcm93ZC1sYXRlc3QuaXQtY3Jvd2Quc3ZjLnN0Zy5rOHMubzMucnUiLCJodHRwOi8vaXQtY3Jvd2QtcmVsZWFzZS0yMDI0LTA3LTIzLTA0LWNyb25qb2JzLml0LWNyb3dkLnN2Yy5zdGcuazhzLm8zLnJ1Il0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJ1c2VyIl19LCJzY29wZSI6Im9wZW5pZCBhZGRyZXNzIHByb2ZpbGUgZW1haWwgcm9sZXMgazhzLmFsZXJ0cy1yZWdpc3RyeSBtaWNyb3Byb2ZpbGUtand0IHBob25lIiwic2lkIjoiYmQyNzA4ZGMtMDFiNy00MTkwLTg1NTItYjY0YzUwNWUxNTgzIiwidXBuIjoidnBvbGV0YW5za2l5IiwiYWRkcmVzcyI6e30sIm5hbWUiOiJWaWt0b3IgUG9sZXRhbnNraXkiLCJncm91cHMiOlsidXNlciJdLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ2cG9sZXRhbnNraXkiLCJnaXZlbl9uYW1lIjoiVmlrdG9yIiwibWlkZGxlX25hbWUiOiJBbGVrc2FuZHJvdmljaCIsImZhbWlseV9uYW1lIjoiUG9sZXRhbnNraXkiLCJlbWFpbCI6InZwb2xldGFuc2tpeUBvem9uLnJ1In0.OuHisxbsqqRSb5qaBCL_Nb68aLj3N6AaA6XE0XdgpAO_F68QxwezcSI96BH71LzLn6XzXrVz5Fk0mVBYXK13cAxdQJxbexOAySXrZqUBYwcXwNKIz5Bsb7aCTSu6_b-dYiHVHhDZCuR_rUWKbaHatZblIt93mh-d1ErleX-OvKdDyWmTTgvVK-xcw2MYoKssh3XBkYyt8Ll-7A2usK9GN_mPzrswH_c-fxjTumJffEGD4kUF4VQfyGgynntkhtulvGD0H7h6wH1YlZmWUhaQcpxQ2G9d1sd3ZwoolhIQ_X6zHT3z4XQaJ7QKekuB-Aug-u3069XpZ_aamP0u4-uL7A'

each(range(52500, 11800, ~1), id => (
  res := get('http://team-api-latest.stg.a.o3.ru:80/api/v2/resources/postgres/cluster?resourceId='+string(id), {
    accept: 'application/json',
    authorization: auth,
  }, res => (
    res.type :: {
      'resp' -> true :: {
      ~(res.status = 400) & ~(res.status = 404) | id % 500 = 0 ->
          log(string(id) + ' ' + string(res.status) + ' ' + string(res.body))
      }
      _ -> out(string(res))
    }
  ))
))

